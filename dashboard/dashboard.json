[{"apiVersion":"influxdata.com/v2alpha1","kind":"Dashboard","metadata":{"name":"cranky-knuth-980001"},"spec":{"charts":[{"colors":[{"id":"0","name":"thunder","type":"min","hex":"#FFD255","value":95},{"id":"sGPeroH7S7FzH2nP5P3cT","name":"fire","type":"threshold","hex":"#DC4E58","value":105},{"id":"1","name":"curacao","type":"max","hex":"#F95F53","value":110}],"decimalPlaces":2,"height":4,"kind":"Gauge","name":"Cabin Pressure","queries":[{"query":"from(bucket: \"lunar-mission\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r[\"_measurement\"] == \"eclss\")\n  |> filter(fn: (r) => r[\"_field\"] == \"pressure\")\n  |> filter(fn: (r) => r[\"host\"] == \"lunar-gateway\")\n  |> filter(fn: (r) => r[\"unit\"] == \"module-alpha\")\n  |> aggregateWindow(every: v.windowPeriod, fn: mean, createEmpty: false)\n  |> yield(name: \"mean\")"}],"staticLegend":{},"tickSuffix":"kPa","width":4},{"colors":[{"id":"base","name":"white","type":"background","hex":"#ffffff"}],"fieldOptions":[{"displayName":"_time","fieldName":"_time","visible":true},{"displayName":"subsystem","fieldName":"subsystem","visible":true},{"displayName":"battery_voltage","fieldName":"battery_voltage","visible":true},{"displayName":"rpm","fieldName":"rpm","visible":true},{"displayName":"traction","fieldName":"traction","visible":true},{"displayName":"ber","fieldName":"ber","visible":true},{"displayName":"latency","fieldName":"latency","visible":true},{"displayName":"snr","fieldName":"snr","visible":true},{"displayName":"pressure","fieldName":"pressure","visible":true},{"displayName":"radiation","fieldName":"radiation","visible":true},{"displayName":"temperature","fieldName":"temperature","visible":true}],"height":4,"kind":"Table","name":"Latest telemetry snapshot","queries":[{"query":"mob =\n  from(bucket: \"lunar-mission\")\n    |> range(start: -30m)\n    |> filter(fn: (r) => r._measurement == \"mobility\")\n    |> filter(fn: (r) => r.unit == \"rover-01\")\n    |> filter(fn: (r) => r.host == \"lunar-gateway\")\n    |> filter(fn: (r) => r._field == \"battery_voltage\" or r._field == \"rpm\" or r._field == \"traction\")\n    |> last()\n    |> pivot(rowKey: [\"_time\"], columnKey: [\"_field\"], valueColumn: \"_value\")\n    |> map(fn: (r) => ({ r with subsystem: \"MOBILITY\" }))\n    |> keep(columns: [\"subsystem\",\"_time\",\"battery_voltage\",\"rpm\",\"traction\"])\n\neclss =\n  from(bucket: \"lunar-mission\")\n    |> range(start: -30m)\n    |> filter(fn: (r) => r._measurement == \"eclss\")\n    |> filter(fn: (r) => r.unit == \"module-alpha\")\n    |> filter(fn: (r) => r._field == \"pressure\" or r._field == \"temperature\" or r._field == \"radiation\")\n    |> last()\n    |> pivot(rowKey: [\"_time\"], columnKey: [\"_field\"], valueColumn: \"_value\")\n    |> map(fn: (r) => ({ r with subsystem: \"ECLSS\" }))\n    |> keep(columns: [\"subsystem\",\"_time\",\"pressure\",\"temperature\",\"radiation\"])\n\ncomms =\n  from(bucket: \"lunar-mission\")\n    |> range(start: -30m)\n    |> filter(fn: (r) => r._measurement == \"comms\")\n    |> filter(fn: (r) => r.antenna_type == \"high_gain\")\n    |> filter(fn: (r) => r.host == \"lunar-gateway\")\n    |> filter(fn: (r) => r._field == \"snr\" or r._field == \"latency\" or r._field == \"ber\")\n    |> last()\n    |> pivot(rowKey: [\"_time\"], columnKey: [\"_field\"], valueColumn: \"_value\")\n    |> map(fn: (r) => ({ r with subsystem: \"COMMS\" }))\n    |> keep(columns: [\"subsystem\",\"_time\",\"snr\",\"latency\",\"ber\"])\n\nunion(tables: [mob, eclss, comms])\n  |> sort(columns: [\"subsystem\"])"}],"staticLegend":{},"tableOptions":{"fixFirstColumn":true,"sortBy":"_time","verticalTimeAxis":true},"timeFormat":"HH:mm","width":4,"yPos":4},{"axes":[{"label":"Latency","name":"x","domain":[0,900]}],"binCount":15,"colors":[{"id":"xJXVaWj5OV6EqvP1iZBie","name":"Nineteen Eighty Four","type":"scale","hex":"#31C0F6"},{"id":"-5DhzYUdwynAt_NA2HMGN","name":"Nineteen Eighty Four","type":"scale","hex":"#A500A5"},{"id":"nORGPbF5JjvqrdiTZU1zc","name":"Nineteen Eighty Four","type":"scale","hex":"#FF7E27"}],"height":4,"kind":"Histogram","legendColorizeRows":true,"legendOpacity":1,"legendOrientationThreshold":100000000,"name":"Latency distribution","position":"stacked","queries":[{"query":"from(bucket: \"lunar-mission\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r._measurement == \"comms\")\n  |> filter(fn: (r) => r._field == \"latency\")\n  |> filter(fn: (r) => r.antenna_type == \"high_gain\")\n  |> filter(fn: (r) => r.host == \"lunar-gateway\")\n  |> aggregateWindow(every: v.windowPeriod, fn: mean, createEmpty: false)\n  |> keep(columns: [\"_time\",\"_value\"])"}],"staticLegend":{},"width":4,"xCol":"_value","yPos":8},{"axes":[{"name":"x","domain":[0,55]},{"name":"y","domain":[0,900]}],"colors":[{"hex":"#31C0F6"},{"hex":"#BC00B8"},{"hex":"#FF7E27"}],"height":4,"kind":"Scatter","legendColorizeRows":true,"legendOpacity":1,"legendOrientationThreshold":100000000,"name":"SNR vs Latency (High Gain Antenna)","queries":[{"query":"from(bucket: \"lunar-mission\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r._measurement == \"comms\")\n  |> filter(fn: (r) => r._field == \"snr\" or r._field == \"latency\")\n  |> filter(fn: (r) => r.antenna_type == \"high_gain\")\n  |> filter(fn: (r) => r.host == \"lunar-gateway\")\n  |> aggregateWindow(every: v.windowPeriod, fn: mean, createEmpty: false)\n  |> pivot(rowKey: [\"_time\",\"host\",\"antenna_type\"], columnKey: [\"_field\"], valueColumn: \"_value\")\n  |> keep(columns: [\"_time\",\"snr\",\"latency\"])"}],"staticLegend":{},"width":4,"xCol":"snr","yCol":"latency","yPos":12},{"axes":[{"base":"10","name":"x","scale":"linear"},{"base":"10","label":"Battery level","name":"y","scale":"linear","suffix":"%"}],"colorizeRows":true,"colors":[{"id":"xJXVaWj5OV6EqvP1iZBie","name":"Nineteen Eighty Four","type":"scale","hex":"#31C0F6"},{"id":"-5DhzYUdwynAt_NA2HMGN","name":"Nineteen Eighty Four","type":"scale","hex":"#A500A5"},{"id":"nORGPbF5JjvqrdiTZU1zc","name":"Nineteen Eighty Four","type":"scale","hex":"#FF7E27"}],"generateYAxisTicks":["yTickStep","yTickStart"],"geom":"line","height":4,"heightRatio":0.2,"hoverDimension":"auto","kind":"Xy","legendColorizeRows":true,"legendOpacity":1,"legendOrientationThreshold":100000000,"name":"Battery (Critical Discharge Threshold)","opacity":1,"orientationThreshold":100000000,"position":"overlaid","queries":[{"query":"crit = 20.0\r\n\r\nbattery =\r\n  from(bucket: \"lunar-mission\")\r\n    |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n    |> filter(fn: (r) => r._measurement == \"mobility\")\r\n    |> filter(fn: (r) => r._field == \"battery_voltage\")\r\n    |> filter(fn: (r) => r.unit == \"rover-01\")\r\n    |> filter(fn: (r) => r.host == \"lunar-gateway\") // quÃ­talo si no existe\r\n    |> aggregateWindow(every: v.windowPeriod, fn: mean, createEmpty: false)\r\n    |> keep(columns: [\"_time\",\"_value\",\"_field\",\"unit\",\"host\"])\r\n\r\nthreshold =\r\n  battery\r\n    |> map(fn: (r) => ({ r with _value: crit, _field: \"critical_discharge\" }))\r\n\r\nunion(tables: [battery, threshold])"}],"staticLegend":{"colorizeRows":true,"heightRatio":0.2,"opacity":1,"orientationThreshold":100000000,"widthRatio":1},"width":4,"widthRatio":1,"xCol":"_time","yCol":"_value","yPos":16,"yTickStep":10},{"colors":[{"id":"base","name":"laser","type":"text","hex":"#00C9FF"},{"id":"jq-1F0nnvFrMR8BxM4Aag","name":"thunder","type":"text","hex":"#FFD255","value":0.3},{"id":"-WxlSXbKyhe1y5Fxovu16","name":"curacao","type":"text","hex":"#F95F53","value":0.9},{"id":"zI_c_wqw_y1lyGktzvIJ-","name":"fire","type":"text","hex":"#DC4E58","value":5}],"decimalPlaces":2,"height":4,"kind":"Single_Stat","name":"Max Radiation","queries":[{"query":"from(bucket: \"lunar-mission\")\r\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n  |> filter(fn: (r) => r._measurement == \"eclss\")\r\n  |> filter(fn: (r) => r._field == \"radiation\")\r\n  |> filter(fn: (r) => r.unit == \"module-alpha\")\r\n  |> max()"}],"staticLegend":{},"suffix":" Bq","width":4,"yPos":20},{"axes":[{"label":"RPM","name":"x","domain":[1000,5000]},{"label":"Traction ","name":"y","domain":[0.1,1]}],"binSize":40,"colors":[{"hex":"#000004"},{"hex":"#110a30"},{"hex":"#320a5e"},{"hex":"#57106e"},{"hex":"#781c6d"},{"hex":"#9a2865"},{"hex":"#bc3754"},{"hex":"#d84c3e"},{"hex":"#ed6925"},{"hex":"#f98e09"},{"hex":"#fbb61a"},{"hex":"#f4df53"}],"height":4,"kind":"Heatmap","legendColorizeRows":true,"legendOpacity":1,"legendOrientationThreshold":100000000,"name":"Engine RPM vs Wheel Traction","queries":[{"query":"from(bucket: \"lunar-mission\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r._measurement == \"mobility\")\n  |> filter(fn: (r) => r._field == \"rpm\" or r._field == \"traction\")\n  |> filter(fn: (r) => r.host == \"lunar-gateway\")\n  |> filter(fn: (r) => r.unit == \"rover-01\")\n  |> aggregateWindow(every: v.windowPeriod, fn: mean, createEmpty: false)\n  |> pivot(\n      rowKey: [\"_time\", \"host\", \"unit\"],\n      columnKey: [\"_field\"],\n      valueColumn: \"_value\"\n    )\n  |> keep(columns: [\"_time\", \"host\", \"unit\", \"rpm\", \"traction\"])\n  |> yield(name:\"rpm_traction\")"}],"staticLegend":{},"width":4,"xCol":"rpm","yCol":"traction","yPos":24}],"name":"Mission Control"}}]